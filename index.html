<!doctype html>
<html lang="fi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vireystilaa vakauttavat kortit ‚Äì online</title>

  <!-- (valinnainen) poistaa favicon 404 -->
  <link rel="icon" href="data:," />

  <style>
    :root{
      --bg:#f7f6fb;
      --card:#ffffff;
      --text:#1f2330;
      --muted:#5c637a;
      --border:#e6e5ee;
      --shadow: 0 10px 30px rgba(20, 20, 40, 0.08);
      --radius: 18px;
      --pill:#fbfbfe;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: linear-gradient(180deg, #f7f6fb, #f2f5fb);
      color: var(--text);
    }
    header{
      padding: 22px 16px 10px;
      max-width: 1100px;
      margin: 0 auto;
    }
    h1{
      font-size: 20px;
      margin: 0 0 6px;
      letter-spacing: 0.2px;
    }
    .sub{
      margin:0;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.45;
    }

    main{
      max-width: 1100px;
      margin: 0 auto;
      padding: 12px 16px 24px;
      display: grid;
      gap: 12px;
    }

    .toolbar{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      background: rgba(255,255,255,0.7);
      border:1px solid var(--border);
      border-radius: var(--radius);
      padding: 12px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
    }

    .left, .right{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}

    select, button{
      border:1px solid var(--border);
      background:#fff;
      color:var(--text);
      padding:10px 12px;
      border-radius: 12px;
      font-size: 14px;
      cursor:pointer;
    }
    button:hover{filter:brightness(0.985)}
    button:active{transform: translateY(1px)}
    button.secondary{
      background: var(--pill);
    }

    .layout{
      display:grid;
      grid-template-columns: 1.25fr 0.75fr;
      gap: 12px;
    }
    @media (max-width: 920px){
      .layout{grid-template-columns: 1fr}
    }

    .card{
      background: var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      min-height: 420px;
      display:flex;
      flex-direction:column;
    }

    .cardTop{
      padding: 16px 16px 10px;
      display:flex;
      gap:10px;
      align-items:flex-start;
      justify-content:space-between;
      border-bottom:1px solid var(--border);
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      border: 1px solid var(--border);
      color: var(--muted);
      background: #fbfbfe;
      white-space:nowrap;
    }
    .title{
      font-size: 18px;
      margin: 0;
      line-height: 1.2;
    }
    .meta{
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 13px;
    }

    .cardBody{
      padding: 16px;
      display:flex;
      flex-direction:column;
      gap: 10px;
      flex:1;
    }

    .imgWrap{
      width: 100%;
      border: 1px solid var(--border);
      border-radius: 16px;
      overflow: hidden;
      background: #fff;
    }

    img.cardImage{
      width:100%;
      height:auto;
      display:block;
    }

    .hint{
      margin:0;
      color:var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }

    .cardActions{
      padding: 12px 16px;
      border-top: 1px solid var(--border);
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      background: #fcfcff;
    }

    .list{
      background: rgba(255,255,255,0.7);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .listHeader{
      padding: 12px 14px;
      border-bottom:1px solid var(--border);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .search{
      flex:1;
      border:1px solid var(--border);
      padding:10px 12px;
      border-radius: 12px;
      font-size: 14px;
      outline:none;
      background:#fff;
    }
    .count{
      color:var(--muted);
      font-size: 13px;
      white-space:nowrap;
    }

    .items{
      max-height: 520px;
      overflow:auto;
    }
    .item{
      padding: 12px 14px;
      border-bottom:1px solid var(--border);
      cursor:pointer;
      background: transparent;
    }
    .item:hover{background:#fbfbfe}
    .itemTitle{
      margin:0;
      font-size: 14px;
      line-height: 1.25;
    }
    .itemMeta{
      margin:6px 0 0;
      font-size: 12px;
      color: var(--muted);
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }

    .pill{
      padding: 3px 8px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fff;
      font-size: 12px;
      color: var(--muted);
    }

    .footer{
      max-width:1100px;
      margin: 0 auto;
      padding: 0 16px 28px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.5;
    }
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      border:1px solid var(--border);
      border-bottom-width:2px;
      padding: 1px 6px;
      border-radius: 8px;
      background:#fff;
      color: var(--muted);
    }

    /* PRINT */
    @media print {
      body{ background:#fff; }
      header, .toolbar, .list, .footer { display:none !important; }
      main { padding:0; max-width:none; }
      .layout{ grid-template-columns: 1fr; }
      .card{ box-shadow:none; border:none; border-radius:0; }
      .cardTop{ border:none; padding:0 0 10px 0; }
      .cardActions{ display:none !important; }

      .printGrid{
        display:grid !important;
        grid-template-columns: 1fr;
        gap: 14px;
      }
      .printCard{
        page-break-inside: avoid;
        border: 1px solid #ddd;
        border-radius: 12px;
        padding: 10px;
      }
      .printTitle{
        font-size: 14px;
        margin: 0 0 8px 0;
        color:#111;
      }
      .printMeta{
        font-size: 11px;
        color:#444;
        margin: 0 0 10px 0;
      }
      .printImg{
        width:100%;
        height:auto;
        display:block;
        border: 1px solid #e5e5e5;
        border-radius: 10px;
        overflow:hidden;
      }
      .noPrintNote{ display:none !important; }
    }

    .printArea{ display:none; }
    .printNote{
      margin-top: 6px;
      font-size: 12px;
      color: var(--muted);
    }
  </style>
</head>

<body>
  <header>
    <h1>Vireystilaa vakauttavat kortit ‚Äì online üß†‚ú®</h1>
    <p class="sub">
      Suodata tilan mukaan, selaa ja k√§√§nn√§ etu/taka.
      <br/>Pikan√§pp√§imet: <span class="kbd">‚Üê</span>/<span class="kbd">‚Üí</span> vaihda korttia, <span class="kbd">Space</span> k√§√§nn√§.
    </p>
  </header>

  <main>
    <div class="toolbar">
      <div class="left">
        <select id="stateFilter" aria-label="Suodata vireystilan mukaan">
          <option value="all">Kaikki tilat</option>
          <option value="ylivire">Ylivire</option>
          <option value="alivire">Alivire</option>
          <option value="tasapaino">Tasapaino</option>
        </select>

        <button id="randomBtn" class="secondary">üé≤ Satunnainen</button>
      </div>

      <div class="right">
        <button id="printOneBtn" class="secondary">üñ®Ô∏è Tulosta t√§m√§</button>
        <button id="printPackBtn" class="secondary">üóÇÔ∏è Tulosta suodatetut</button>
        <button id="prevBtn">‚Üê Edellinen</button>
        <button id="nextBtn">Seuraava ‚Üí</button>
      </div>
    </div>

    <div class="layout">
      <section class="card" aria-live="polite">
        <div class="cardTop">
          <div>
            <h2 class="title" id="cardTitle">‚Äî</h2>
            <p class="meta" id="cardMeta">‚Äî</p>
          </div>
          <div class="badge" id="cardBadge">‚Äî</div>
        </div>

        <div class="cardBody">
          <div class="imgWrap">
            <img id="cardImage" class="cardImage" alt="">
          </div>
          <p class="hint" id="cardHint">‚Äî</p>
          <p class="printNote noPrintNote" id="printNote">Vinkki: tulostaessa selaimesi asetuksista ‚Äútaustagrafiikka‚Äù voi olla pois p√§√§lt√§ ‚Äì se ei haittaa kuvia.</p>
        </div>

        <div class="cardActions">
          <button id="flipBtn">üîÅ K√§√§nn√§ kortti</button>
        </div>
      </section>

      <aside class="list">
        <div class="listHeader">
          <input id="search" class="search" placeholder="Hae (otsikosta tai tageista)..." />
          <div class="count" id="countLabel">‚Äî</div>
        </div>
        <div class="items" id="items"></div>
      </aside>
    </div>

    <!-- Print area (filled by JS, visible only in print) -->
    <div class="printArea" id="printArea"></div>
  </main>

  <div class="footer">
    T√§m√§ on kuvapohjainen testiversio. Korttikuvat haetaan polusta <b>assets/cards/</b>.
    <br/>Jos joku kortti ei n√§y: tarkista tiedostonimi + polku + isot/pienet kirjaimet. ‚úÖ
  </div>

  <script>
    // =====================================================
    // 1) MUOKKAA T√ÑM√Ñ OSIO: korttien m√§√§r√§t ja nimet
    // =====================================================
    // OLETUS: kuvat nimill√§
    // 001_front.png ja 001_back.png jne.
    //
    // Tee vain n√§m√§:
    // - NUM_CARDS = montako korttia on
    // - CARD_STATES = kortti-id -> tila
    // - CARD_TITLES = kortti-id -> otsikko (valinnainen)
    // - CARD_TAGS = kortti-id -> tagit (valinnainen)
    //
    const NUM_CARDS = 2;
         const CARD_STATES = {
      // "001": "ylivire",
      // "002": "alivire",
      // ...
    };

    // OTSIKOT (valinnainen). Jos puuttuu, otsikko = "Kortti 001"
    const CARD_TITLES = {
      // "001": "Hidasta: 3 ankkuria tilaan",
      // ...
    };

    // TAGIT (valinnainen)
    const CARD_TAGS = {
      // "001": ["ankkurointi","turva"],
      // ...
    };

    // =====================================================
    // 2) DATA GENEROINTI
    // =====================================================
    function pad3(n){ return String(n).padStart(3, "0"); }

    const CARDS = Array.from({length: NUM_CARDS}, (_, i) => {
      const id = pad3(i+1);
      return {
        id,
        state: CARD_STATES[id] || "tasapaino",
        title: CARD_TITLES[id] || `Kortti ${id}`,
        imgFront: `assets/cards/${id}_front.png`,
        imgBack:  `assets/cards/${id}_back.png`,
        tags: CARD_TAGS[id] || []
      };
    });

    // =====================================================
    // 3) APP STATE
    // =====================================================
    const els = {
      stateFilter: document.getElementById("stateFilter"),
      randomBtn: document.getElementById("randomBtn"),
      prevBtn: document.getElementById("prevBtn"),
      nextBtn: document.getElementById("nextBtn"),
      flipBtn: document.getElementById("flipBtn"),
      printOneBtn: document.getElementById("printOneBtn"),
      printPackBtn: document.getElementById("printPackBtn"),

      cardTitle: document.getElementById("cardTitle"),
      cardMeta: document.getElementById("cardMeta"),
      cardBadge: document.getElementById("cardBadge"),
      cardImage: document.getElementById("cardImage"),
      cardHint: document.getElementById("cardHint"),
      printNote: document.getElementById("printNote"),

      items: document.getElementById("items"),
      search: document.getElementById("search"),
      countLabel: document.getElementById("countLabel"),
      printArea: document.getElementById("printArea"),
    };

    const STORAGE_KEY = "vireyskortit_last_img";
    let filtered = [...CARDS];
    let currentIndex = 0;
    let showFront = true;

    function stateLabel(state){
      if(state === "ylivire") return "Ylivire";
      if(state === "alivire") return "Alivire";
      return "Tasapaino";
    }

    function applyFilters(){
      const state = els.stateFilter.value;
      const q = (els.search.value || "").trim().toLowerCase();

      filtered = CARDS.filter(c => {
        const okState = (state === "all") ? true : (c.state === state);
        const hay = (c.title + " " + (c.tags||[]).join(" ")).toLowerCase();
        const okQ = q ? hay.includes(q) : true;
        return okState && okQ;
      });

      if(filtered.length === 0){
        els.items.innerHTML = `<div class="item"><p class="itemTitle">Ei osumia. üòÖ</p><p class="itemMeta">Kokeile eri hakusanaa tai suodatusta.</p></div>`;
        els.countLabel.textContent = "0 korttia";
        renderEmptyCard();
        return;
      }

      els.countLabel.textContent = `${filtered.length} korttia`;
      currentIndex = Math.min(currentIndex, filtered.length - 1);
      renderList();
      renderCard();
    }

    function renderEmptyCard(){
      els.cardTitle.textContent = "‚Äî";
      els.cardMeta.textContent = "‚Äî";
      els.cardBadge.textContent = "‚Äî";
      els.cardHint.textContent = "‚Äî";
      els.cardImage.removeAttribute("src");
    }

    function renderList(){
      els.items.innerHTML = filtered.map((c, idx) => {
        const tags = (c.tags || []).slice(0,3).map(t => `<span class="pill">#${t}</span>`).join(" ");
        return `
          <div class="item" data-idx="${idx}">
            <p class="itemTitle">${c.title}</p>
            <div class="itemMeta">
              <span class="pill">${stateLabel(c.state)}</span>
              ${tags}
            </div>
          </div>
        `;
      }).join("");

      els.items.querySelectorAll(".item").forEach(node => {
        node.addEventListener("click", () => {
          currentIndex = Number(node.dataset.idx);
          showFront = true;
          renderCard();
          saveLast();
        });
      });
    }

    function renderCard(){
      const c = filtered[currentIndex];
      if(!c){ renderEmptyCard(); return; }

      els.cardTitle.textContent = c.title;
      els.cardMeta.textContent = `Kortti ${currentIndex+1}/${filtered.length} ‚Ä¢ ID: ${c.id}`;
      els.cardBadge.textContent = `ü´ß ${stateLabel(c.state)}`;

      const img = showFront ? c.imgFront : (c.imgBack || c.imgFront);
      els.cardImage.src = img;

      els.cardHint.textContent = showFront
        ? "Etu: kortin etupuoli. K√§√§nn√§ n√§hd√§ksesi takapuolen."
        : "Taka: kortin takapuoli. K√§√§nn√§ takaisin etupuolelle.";

      els.flipBtn.textContent = showFront ? "üîÅ K√§√§nn√§ kortti" : "‚Ü©Ô∏è Takaisin etupuolelle";
    }

    function next(){
      if(filtered.length === 0) return;
      currentIndex = (currentIndex + 1) % filtered.length;
      showFront = true;
      renderCard();
      saveLast();
    }

    function prev(){
      if(filtered.length === 0) return;
      currentIndex = (currentIndex - 1 + filtered.length) % filtered.length;
      showFront = true;
      renderCard();
      saveLast();
    }

    function randomPick(){
      if(filtered.length === 0) return;
      currentIndex = Math.floor(Math.random() * filtered.length);
      showFront = true;
      renderCard();
      saveLast();
    }

    function flip(){
      if(filtered.length === 0) return;
      showFront = !showFront;
      renderCard();
    }

    function saveLast(){
      const c = filtered[currentIndex];
      if(!c) return;
      localStorage.setItem(STORAGE_KEY, JSON.stringify({
        id: c.id,
        stateFilter: els.stateFilter.value,
        search: els.search.value || "",
        showFront
      }));
    }

    function loadLast(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return;
        const last = JSON.parse(raw);
        if(last.stateFilter) els.stateFilter.value = last.stateFilter;
        if(typeof last.search === "string") els.search.value = last.search;

        applyFilters();
        const idx = filtered.findIndex(x => x.id === last.id);
        if(idx >= 0){
          currentIndex = idx;
        }
        showFront = (typeof last.showFront === "boolean") ? last.showFront : true;
        renderCard();
      }catch(_){}
    }

    // =====================================================
    // PRINT
    // =====================================================
    function buildPrintHTML(cardsToPrint){
      // Print area is only for printing
      const blocks = cardsToPrint.map(c => {
        const title = c.title;
        const meta = `ID: ${c.id} ‚Ä¢ ${stateLabel(c.state)} ‚Ä¢ etu + taka`;
        const front = c.imgFront;
        const back = c.imgBack || c.imgFront;

        return `
          <div class="printCard">
            <p class="printTitle">${escapeHtml(title)}</p>
            <p class="printMeta">${escapeHtml(meta)}</p>
            <img class="printImg" src="${front}" alt="">
            <div style="height:10px"></div>
            <img class="printImg" src="${back}" alt="">
          </div>
        `;
      }).join("");

      return `<div class="printGrid">${blocks}</div>`;
    }

    function escapeHtml(s){
      return String(s).replace(/[&<>"']/g, (m) => ({
        "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#039;"
      }[m]));
    }

    function printOne(){
      if(filtered.length === 0) return;
      const c = filtered[currentIndex];
      els.printArea.innerHTML = buildPrintHTML([c]);
      els.printArea.classList.add("printGrid");
      window.print();
    }

    function printPack(){
      if(filtered.length === 0) return;
      // Tulostetaan kaikki suodatetut kortit (etu+taka)
      els.printArea.innerHTML = buildPrintHTML(filtered);
      els.printArea.classList.add("printGrid");
      window.print();
    }

    // =====================================================
    // EVENTS
    // =====================================================
    els.stateFilter.addEventListener("change", () => { applyFilters(); saveLast(); });
    els.search.addEventListener("input", () => { applyFilters(); saveLast(); });

    els.nextBtn.addEventListener("click", next);
    els.prevBtn.addEventListener("click", prev);
    els.randomBtn.addEventListener("click", randomPick);
    els.flipBtn.addEventListener("click", flip);

    els.printOneBtn.addEventListener("click", printOne);
    els.printPackBtn.addEventListener("click", printPack);

    window.addEventListener("keydown", (e) => {
      if(e.key === "ArrowRight") next();
      if(e.key === "ArrowLeft") prev();
      if(e.key === " ") { e.preventDefault(); flip(); }
    });

    // INIT
    applyFilters();
    loadLast();
    renderCard();
  </script>
</body>
</html>

