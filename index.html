<!doctype html>
<html lang="fi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vireystilaa vakauttavat kortit ‚Äì testiversio</title>
  <style>
    :root{
      --bg:#f7f6fb;
      --card:#ffffff;
      --text:#1f2330;
      --muted:#5c637a;
      --border:#e6e5ee;
      --shadow: 0 10px 30px rgba(20, 20, 40, 0.08);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background: linear-gradient(180deg, #f7f6fb, #f2f5fb);
      color: var(--text);
    }
    header{
      padding: 22px 16px 10px;
      max-width: 980px;
      margin: 0 auto;
    }
    h1{
      font-size: 20px;
      margin: 0 0 6px;
      letter-spacing: 0.2px;
    }
    .sub{
      margin:0;
      color: var(--muted);
      font-size: 14px;
      line-height: 1.4;
    }

    main{
      max-width: 980px;
      margin: 0 auto;
      padding: 12px 16px 24px;
      display: grid;
      gap: 12px;
    }

    .toolbar{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      background: rgba(255,255,255,0.7);
      border:1px solid var(--border);
      border-radius: var(--radius);
      padding: 12px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(6px);
    }

    .left, .right{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}

    select, button{
      border:1px solid var(--border);
      background:#fff;
      color:var(--text);
      padding:10px 12px;
      border-radius: 12px;
      font-size: 14px;
      cursor:pointer;
    }
    button:hover{filter:brightness(0.98)}
    button:active{transform: translateY(1px)}

    .layout{
      display:grid;
      grid-template-columns: 1.2fr 0.8fr;
      gap: 12px;
    }
    @media (max-width: 880px){
      .layout{grid-template-columns: 1fr}
    }

    .card{
      background: var(--card);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      min-height: 340px;
      display:flex;
      flex-direction:column;
    }

    .cardTop{
      padding: 16px 16px 10px;
      display:flex;
      gap:10px;
      align-items:flex-start;
      justify-content:space-between;
      border-bottom:1px solid var(--border);
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 12px;
      border: 1px solid var(--border);
      color: var(--muted);
      background: #fbfbfe;
      white-space:nowrap;
    }
    .title{
      font-size: 18px;
      margin: 0;
      line-height: 1.2;
    }
    .meta{
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 13px;
    }

    .cardBody{
      padding: 16px;
      display:flex;
      flex-direction:column;
      gap: 10px;
      flex:1;
    }
    .big{
      font-size: 18px;
      line-height: 1.45;
      margin:0;
    }
    .hint{
      margin:0;
      color:var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }

    .cardActions{
      padding: 12px 16px;
      border-top: 1px solid var(--border);
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      background: #fcfcff;
    }

    .list{
      background: rgba(255,255,255,0.7);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .listHeader{
      padding: 12px 14px;
      border-bottom:1px solid var(--border);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .search{
      flex:1;
      border:1px solid var(--border);
      padding:10px 12px;
      border-radius: 12px;
      font-size: 14px;
      outline:none;
      background:#fff;
    }
    .count{
      color:var(--muted);
      font-size: 13px;
      white-space:nowrap;
    }

    .items{
      max-height: 420px;
      overflow:auto;
    }
    .item{
      padding: 12px 14px;
      border-bottom:1px solid var(--border);
      cursor:pointer;
      background: transparent;
    }
    .item:hover{background:#fbfbfe}
    .itemTitle{
      margin:0;
      font-size: 14px;
      line-height: 1.25;
    }
    .itemMeta{
      margin:6px 0 0;
      font-size: 12px;
      color: var(--muted);
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }

    .pill{
      padding: 3px 8px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fff;
      font-size: 12px;
      color: var(--muted);
    }
    .footer{
      max-width:980px;
      margin: 0 auto;
      padding: 0 16px 28px;
      color: var(--muted);
      font-size: 12px;
      line-height: 1.5;
    }
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      border:1px solid var(--border);
      border-bottom-width:2px;
      padding: 1px 6px;
      border-radius: 8px;
      background:#fff;
      color: var(--muted);
    }
  </style>
</head>

<body>
  <header>
    <h1>Vireystilaa vakauttavat kortit ‚Äì testiversio üß†‚ú®</h1>
    <p class="sub">
      Avaa kortti, k√§√§nn√§ (etu/taka), suodata tilan mukaan ja arvo satunnainen.
      <br/>Pikan√§pp√§imet: <span class="kbd">‚Üê</span>/<span class="kbd">‚Üí</span> vaihda korttia, <span class="kbd">Space</span> k√§√§nn√§.
    </p>
  </header>

  <main>
    <div class="toolbar">
      <div class="left">
        <select id="stateFilter" aria-label="Suodata vireystilan mukaan">
          <option value="all">Kaikki tilat</option>
          <option value="ylivire">Ylivire</option>
          <option value="alivire">Alivire</option>
          <option value="tasapaino">Tasapaino</option>
        </select>

        <button id="randomBtn">üé≤ Satunnainen</button>
      </div>

      <div class="right">
        <button id="prevBtn">‚Üê Edellinen</button>
        <button id="nextBtn">Seuraava ‚Üí</button>
      </div>
    </div>

    <div class="layout">
      <section class="card" aria-live="polite">
        <div class="cardTop">
          <div>
            <h2 class="title" id="cardTitle">‚Äî</h2>
            <p class="meta" id="cardMeta">‚Äî</p>
          </div>
          <div class="badge" id="cardBadge">‚Äî</div>
        </div>

        <div class="cardBody">
          <p class="big" id="cardMain">‚Äî</p>
          <p class="hint" id="cardHint">‚Äî</p>
        </div>

        <div class="cardActions">
          <button id="flipBtn">üîÅ K√§√§nn√§ kortti</button>
          <button id="copyBtn">üìã Kopioi teksti</button>
        </div>
      </section>

      <aside class="list">
        <div class="listHeader">
          <input id="search" class="search" placeholder="Hae korttia (esim. hengitys, liike, turva)..." />
          <div class="count" id="countLabel">‚Äî</div>
        </div>
        <div class="items" id="items"></div>
      </aside>
    </div>
  </main>

  <div class="footer">
    Testiversio on tarkoituksella yksinkertainen. Kun t√§√§ toimii, seuraavat stepit on:
    1) lis√§√§ sun oikeat korttitekstit, 2) lis√§√§ kuvat, 3) julkaise GitHub Pages / Netlify. üöÄ
  </div>

  <script>
    
    window.addEventListener("error", (e) => {
  const msg = `JS ERROR: ${e.message}\nFile: ${e.filename}\nLine: ${e.lineno}:${e.colno}`;
  alert(msg);
});

console.log("JS started ‚úÖ");

    // ========== DATA: muokkaa n√§m√§ sun korteiksi ==========
    // state: "ylivire" | "alivire" | "tasapaino"
    const CARDS = [
      {
        id: "yli-1",
        state: "ylivire",
        title: "Hidasta: 3 ankkuria tilaan",
        front: "Katso ymp√§rillesi ja nime√§ hiljaa: 3 asiaa jonka n√§√§t, 2 √§√§nt√§ jonka kuulet, 1 tunne kehossa.",
        back: "Tavoite: siirt√§√§ huomio pois uhasta t√§h√§n hetkeen. Tee t√§m√§ rauhallisesti 20‚Äì60 sekuntia.",
        tags: ["ankkurointi", "aistit", "turva"]
      },
      {
        id: "yli-2",
        state: "ylivire",
        title: "Pidempi uloshengitys",
        front: "Hengit√§ sis√§√§n 3‚Äì4 sek, ulos 5‚Äì7 sek. Toista 6 kierrosta.",
        back: "Jos huimaa: lyhenn√§ kierrosta. Ajatus ei ole ‚Äòsuorittaa‚Äô vaan antaa keholle viesti: nyt ei ole kiire.",
        tags: ["hengitys", "rauhoittuminen"]
      },
      {
        id: "ali-1",
        state: "alivire",
        title: "Her√§ttely: paina jalat maahan",
        front: "Nouse seisomaan. Paina jalkapohjia lattiaan 5 x 3 sek. Ravista k√§si√§ 15 sek.",
        back: "Tavoite: lis√§t√§ kehon aktivaatioita lempe√§sti. Jos tulee levoton olo, v√§henn√§ ravistelua.",
        tags: ["liike", "aktivointi"]
      },
      {
        id: "ali-2",
        state: "alivire",
        title: "Kylm√§ + liike (mini)",
        front: "Huuhtele k√§det kylm√§ll√§ vedell√§ 10‚Äì20 sek ja tee sen j√§lkeen 30 sek reipasta k√§vely√§ paikallaan.",
        back: "Tavoite: nostaa virett√§ nopeasti ja turvallisesti. Ei jos syd√§n oireilee tai kylm√§ tuntuu pahalta.",
        tags: ["kylm√§", "liike"]
      },
      {
        id: "tas-1",
        state: "tasapaino",
        title: "Pid√§ kiinni hyv√§st√§",
        front: "Huomaa 1 asia joka on nyt ok. Anna sen tuntua kehossa 10‚Äì20 sek.",
        back: "Tavoite: vahvistaa palautumisen muistij√§lke√§. Pieni riitt√§√§.",
        tags: ["resurssi", "turva"]
      },
      {
        id: "tas-2",
        state: "tasapaino",
        title: "4H: Huomioi ‚Äì Hempe√§sti hyv√§ksy",
        front: "Sano hiljaa: ‚ÄòT√§ss√§ on t√§m√§ hetki.‚Äô Ja hengit√§ kerran rauhassa ulos.",
        back: "Tavoite: v√§hent√§√§ vastustusta. Ei tarvitse tyk√§t√§ olosta, riitt√§√§ ett√§ tunnistat sen.",
        tags: ["4H", "hyv√§ksynt√§"]
      }
    ];

    // ========== APP STATE ==========
    const els = {
      stateFilter: document.getElementById("stateFilter"),
      randomBtn: document.getElementById("randomBtn"),
      prevBtn: document.getElementById("prevBtn"),
      nextBtn: document.getElementById("nextBtn"),
      flipBtn: document.getElementById("flipBtn"),
      copyBtn: document.getElementById("copyBtn"),
      cardTitle: document.getElementById("cardTitle"),
      cardMeta: document.getElementById("cardMeta"),
      cardBadge: document.getElementById("cardBadge"),
      cardMain: document.getElementById("cardMain"),
      cardHint: document.getElementById("cardHint"),
      items: document.getElementById("items"),
      search: document.getElementById("search"),
      countLabel: document.getElementById("countLabel"),
    };

    const STORAGE_KEY = "vireyskortit_last";
    let filtered = [...CARDS];
    let currentIndex = 0;
    let showFront = true;

    function stateLabel(state){
      if(state === "ylivire") return "Ylivire";
      if(state === "alivire") return "Alivire";
      return "Tasapaino";
    }

    function applyFilters(){
      const state = els.stateFilter.value;
      const q = (els.search.value || "").trim().toLowerCase();

      filtered = CARDS.filter(c => {
        const okState = (state === "all") ? true : (c.state === state);
        const hay = (c.title + " " + c.front + " " + c.back + " " + (c.tags||[]).join(" ")).toLowerCase();
        const okQ = q ? hay.includes(q) : true;
        return okState && okQ;
      });

      if(filtered.length === 0){
        els.items.innerHTML = `<div class="item"><p class="itemTitle">Ei osumia. üòÖ</p><p class="itemMeta">Kokeile eri hakusanaa tai suodatusta.</p></div>`;
        els.countLabel.textContent = "0 korttia";
        renderEmptyCard();
        return;
      }

      els.countLabel.textContent = `${filtered.length} korttia`;
      currentIndex = Math.min(currentIndex, filtered.length - 1);
      renderList();
      renderCard();
    }

    function renderEmptyCard(){
      els.cardTitle.textContent = "‚Äî";
      els.cardMeta.textContent = "‚Äî";
      els.cardBadge.textContent = "‚Äî";
      els.cardMain.textContent = "‚Äî";
      els.cardHint.textContent = "‚Äî";
    }

    function renderList(){
      els.items.innerHTML = filtered.map((c, idx) => {
        const tags = (c.tags || []).slice(0,3).map(t => `<span class="pill">#${t}</span>`).join(" ");
        return `
          <div class="item" data-idx="${idx}">
            <p class="itemTitle">${c.title}</p>
            <div class="itemMeta">
              <span class="pill">${stateLabel(c.state)}</span>
              ${tags}
            </div>
          </div>
        `;
      }).join("");

      els.items.querySelectorAll(".item").forEach(node => {
        node.addEventListener("click", () => {
          currentIndex = Number(node.dataset.idx);
          showFront = true;
          renderCard();
          saveLast();
        });
      });
    }

    function renderCard(){
      const c = filtered[currentIndex];
      if(!c){ renderEmptyCard(); return; }

      els.cardTitle.textContent = c.title;
      els.cardMeta.textContent = `Kortti ${currentIndex+1}/${filtered.length} ‚Ä¢ ID: ${c.id}`;
      els.cardBadge.textContent = `üîé ${stateLabel(c.state)}`;

      const text = showFront ? c.front : c.back;
      els.cardMain.textContent = text;

      els.cardHint.textContent = showFront
        ? "Etu: harjoite / ohje. K√§√§nn√§ kortti n√§hd√§ksesi lis√§ohjeen."
        : "Taka: miksi t√§m√§ toimii / miten soveltaa. K√§√§nn√§ takaisin etupuolelle.";

      els.flipBtn.textContent = showFront ? "üîÅ K√§√§nn√§ kortti" : "‚Ü©Ô∏è Takaisin etupuolelle";
    }

    function next(){
      if(filtered.length === 0) return;
      currentIndex = (currentIndex + 1) % filtered.length;
      showFront = true;
      renderCard();
      saveLast();
    }

    function prev(){
      if(filtered.length === 0) return;
      currentIndex = (currentIndex - 1 + filtered.length) % filtered.length;
      showFront = true;
      renderCard();
      saveLast();
    }

    function randomPick(){
      if(filtered.length === 0) return;
      currentIndex = Math.floor(Math.random() * filtered.length);
      showFront = true;
      renderCard();
      saveLast();
    }

    function flip(){
      if(filtered.length === 0) return;
      showFront = !showFront;
      renderCard();
    }

    async function copyText(){
      if(filtered.length === 0) return;
      const c = filtered[currentIndex];
      const text = `${c.title}\n\n${showFront ? c.front : c.back}`;
      try{
        await navigator.clipboard.writeText(text);
        els.copyBtn.textContent = "‚úÖ Kopioitu";
        setTimeout(()=> els.copyBtn.textContent = "üìã Kopioi teksti", 900);
      }catch(e){
        alert("Kopiointi ei onnistunut t√§ss√§ selaimessa. Voit valita tekstin k√§sin.");
      }
    }

    function saveLast(){
      const c = filtered[currentIndex];
      if(!c) return;
      localStorage.setItem(STORAGE_KEY, JSON.stringify({
        id: c.id,
        stateFilter: els.stateFilter.value,
        search: els.search.value || ""
      }));
    }

    function loadLast(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return;
        const last = JSON.parse(raw);
        if(last.stateFilter) els.stateFilter.value = last.stateFilter;
        if(typeof last.search === "string") els.search.value = last.search;

        applyFilters();
        const idx = filtered.findIndex(x => x.id === last.id);
        if(idx >= 0){
          currentIndex = idx;
          showFront = true;
          renderCard();
        }
      }catch(_){}
    }

    // ========== EVENTS ==========
    els.stateFilter.addEventListener("change", () => { applyFilters(); saveLast(); });
    els.search.addEventListener("input", () => { applyFilters(); saveLast(); });

    els.nextBtn.addEventListener("click", next);
    els.prevBtn.addEventListener("click", prev);
    els.randomBtn.addEventListener("click", randomPick);
    els.flipBtn.addEventListener("click", flip);
    els.copyBtn.addEventListener("click", copyText);

    window.addEventListener("keydown", (e) => {
      if(e.key === "ArrowRight") next();
      if(e.key === "ArrowLeft") prev();
      if(e.key === " ") { e.preventDefault(); flip(); }
    });

    // init
    applyFilters();
    loadLast();
    renderCard();
  </script>
</body>
</html>


